{"version":3,"file":null,"sources":["src/base.js"],"sourcesContent":["import r from 'restructure';\nconst fs = require('fs');\n\nvar fontkit = {};\nexport default fontkit;\n\nfontkit.logErrors = false;\n\nlet formats = [];\nfontkit.registerFormat = function(format) {\n  formats.push(format);\n};\n\n// fontkit.openSync = function(filename, postscriptName) {\n//   let buffer = fs.readFileSync(filename);\n//   return fontkit.create(buffer, postscriptName);\n// };\n\nfontkit.open = function(filename, postscriptName, callback) {\n  if (typeof postscriptName === 'function') {\n    callback = postscriptName;\n    postscriptName = null;\n  }\n\n  fs.readFile(filename, function(err, buffer) {\n    if (err) { return callback(err); }\n\n    try {\n      var font = fontkit.create(buffer, postscriptName);\n    } catch (e) {\n      return callback(e);\n    }\n\n    return callback(null, font);\n  });\n\n  return;\n};\n\nfontkit.create = function(buffer, postscriptName) {\n  for (let i = 0; i < formats.length; i++) {\n    let format = formats[i];\n    if (format.probe(buffer)) {\n      let font = new format(new r.DecodeStream(buffer));\n      if (postscriptName) {\n        return font.getFont(postscriptName);\n      }\n\n      return font;\n    }\n  }\n\n  throw new Error('Unknown font format');\n};\n\nfontkit.defaultLanguage = 'en';\nfontkit.setDefaultLanguage = function(lang = 'en') {\n  fontkit.defaultLanguage = lang;\n};"],"names":["fs","require","fontkit","logErrors","formats","registerFormat","format","push","open","filename","postscriptName","callback","readFile","err","buffer","font","create","e","i","length","probe","r","DecodeStream","getFont","Error","defaultLanguage","setDefaultLanguage","lang"],"mappings":";;;;;;AACA,IAAMA,KAAKC,QAAQ,IAAR,CAAX;;AAEA,IAAIC,UAAU,EAAd;AACA,AAEAA,QAAQC,SAAR,GAAoB,KAApB;;AAEA,IAAIC,UAAU,EAAd;AACAF,QAAQG,cAAR,GAAyB,UAASC,MAAT,EAAiB;UAChCC,IAAR,CAAaD,MAAb;CADF;;;;;;;AASAJ,QAAQM,IAAR,GAAe,UAASC,QAAT,EAAmBC,cAAnB,EAAmCC,QAAnC,EAA6C;MACtD,OAAOD,cAAP,KAA0B,UAA9B,EAA0C;eAC7BA,cAAX;qBACiB,IAAjB;;;KAGCE,QAAH,CAAYH,QAAZ,EAAsB,UAASI,GAAT,EAAcC,MAAd,EAAsB;QACtCD,GAAJ,EAAS;aAASF,SAASE,GAAT,CAAP;;;QAEP;UACEE,OAAOb,QAAQc,MAAR,CAAeF,MAAf,EAAuBJ,cAAvB,CAAX;KADF,CAEE,OAAOO,CAAP,EAAU;aACHN,SAASM,CAAT,CAAP;;;WAGKN,SAAS,IAAT,EAAeI,IAAf,CAAP;GATF;;;CANF;;AAqBAb,QAAQc,MAAR,GAAiB,UAASF,MAAT,EAAiBJ,cAAjB,EAAiC;OAC3C,IAAIQ,IAAI,CAAb,EAAgBA,IAAId,QAAQe,MAA5B,EAAoCD,GAApC,EAAyC;QACnCZ,SAASF,QAAQc,CAAR,CAAb;QACIZ,OAAOc,KAAP,CAAaN,MAAb,CAAJ,EAA0B;UACpBC,OAAO,IAAIT,MAAJ,CAAW,IAAIe,EAAEC,YAAN,CAAmBR,MAAnB,CAAX,CAAX;UACIJ,cAAJ,EAAoB;eACXK,KAAKQ,OAAL,CAAab,cAAb,CAAP;;;aAGKK,IAAP;;;;QAIE,IAAIS,KAAJ,CAAU,qBAAV,CAAN;CAbF;;AAgBAtB,QAAQuB,eAAR,GAA0B,IAA1B;AACAvB,QAAQwB,kBAAR,GAA6B,YAAsB;MAAbC,IAAa,uEAAN,IAAM;;UACzCF,eAAR,GAA0BE,IAA1B;CADF;;"}